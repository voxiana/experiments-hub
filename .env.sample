# Voice AI CX Platform - Environment Configuration
# Copy this file to .env and configure for your environment

# ============================================================================
# General
# ============================================================================
ENVIRONMENT=development  # development, staging, production
LOG_LEVEL=INFO
TIMEZONE=Asia/Dubai

# ============================================================================
# Security
# ============================================================================
JWT_SECRET=your-secret-key-change-in-production-use-strong-random-string
JWT_ALGORITHM=HS256
JWT_EXPIRY_HOURS=1

# API Keys (per-tenant, stored in database encrypted in production)
DEFAULT_API_KEY=demo_key_change_me

# ============================================================================
# Database
# ============================================================================
DATABASE_URL=postgresql+asyncpg://voiceai:voiceai@postgres:5432/voiceai
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10

# Redis
REDIS_URL=redis://redis:6379/0
REDIS_MAX_CONNECTIONS=50

# Qdrant (Vector Store)
QDRANT_URL=http://qdrant:6333
QDRANT_API_KEY=  # Optional

# ClickHouse (Analytics)
CLICKHOUSE_HOST=clickhouse
CLICKHOUSE_PORT=9000
CLICKHOUSE_USER=voiceai
CLICKHOUSE_PASSWORD=voiceai
CLICKHOUSE_DATABASE=voiceai_analytics

# ============================================================================
# AI Models
# ============================================================================

# ASR (Whisper)
WHISPER_MODEL=large-v3  # large-v3, distil-large-v3
WHISPER_DEVICE=cuda  # cuda, cpu
WHISPER_COMPUTE_TYPE=float16  # float16, int8
WHISPER_BEAM_SIZE=1  # 1-5 (higher = more accurate, slower)

# NLU (vLLM)
VLLM_MODEL=Qwen/Qwen2.5-72B-Instruct  # or meta-llama/Llama-3.1-70B-Instruct
VLLM_URL=http://vllm:8000/v1
VLLM_MAX_TOKENS=200
VLLM_TEMPERATURE=0.7

# TTS (XTTS v2)
TTS_MODEL=tts_models/multilingual/multi-dataset/xtts_v2
TTS_DEVICE=cuda
TTS_SAMPLE_RATE=24000

# Embeddings (RAG)
EMBEDDING_MODEL=BAAI/bge-m3
RERANKER_MODEL=BAAI/bge-reranker-v2-m3
EMBEDDING_DEVICE=cuda

# ============================================================================
# Service URLs (Internal)
# ============================================================================
GATEWAY_URL=http://gateway:8000
ASR_SERVICE_URL=asr-service:50051
NLU_SERVICE_URL=http://nlu-service:8001
TTS_SERVICE_URL=http://tts-service:8002
RAG_SERVICE_URL=http://rag-service:8080
CONNECTORS_URL=http://connectors:8090

# ============================================================================
# CRM Connectors (Configure per tenant)
# ============================================================================

# Salesforce
SALESFORCE_CLIENT_ID=
SALESFORCE_CLIENT_SECRET=
SALESFORCE_USERNAME=
SALESFORCE_PASSWORD=

# Zendesk
ZENDESK_SUBDOMAIN=
ZENDESK_EMAIL=
ZENDESK_API_TOKEN=

# HubSpot
HUBSPOT_API_KEY=

# Freshdesk
FRESHDESK_DOMAIN=
FRESHDESK_API_KEY=

# ============================================================================
# LiveChat / Handoff
# ============================================================================
LIVECHAT_LICENSE_ID=
LIVECHAT_CLIENT_ID=
LIVECHAT_CLIENT_SECRET=
LIVECHAT_ACCESS_TOKEN=

# Or use webhook for custom integration
HANDOFF_WEBHOOK_URL=
HANDOFF_AUTH_TOKEN=

# ============================================================================
# Observability
# ============================================================================

# Langfuse (LLM Observability)
LANGFUSE_PUBLIC_KEY=
LANGFUSE_SECRET_KEY=
LANGFUSE_HOST=https://cloud.langfuse.com  # or self-hosted

# Sentry (Error Tracking)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development

# Prometheus
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# OpenTelemetry
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4317
OTEL_SERVICE_NAME=voiceai-gateway

# ============================================================================
# Celery (Workers)
# ============================================================================
CELERY_BROKER_URL=redis://redis:6379/1
CELERY_RESULT_BACKEND=redis://redis:6379/1
CELERY_WORKER_CONCURRENCY=4

# ============================================================================
# Rate Limiting
# ============================================================================
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_WINDOW_SECONDS=60

# ============================================================================
# Data Retention & Compliance
# ============================================================================
TRANSCRIPT_RETENTION_DAYS=90  # Auto-delete after N days
RECORDING_RETENTION_DAYS=30
CALL_RECORDING_ENABLED=false  # Opt-in per call
PII_REDACTION_ENABLED=true

# Data residency
DATA_REGION=uae  # uae, eu, us

# ============================================================================
# Feature Flags
# ============================================================================
ENABLE_DIARIZATION=true
ENABLE_EMOTION_ANALYSIS=true
ENABLE_RERANKER=true
ENABLE_STREAMING_TTS=true

# ============================================================================
# Performance Tuning
# ============================================================================

# ASR
ASR_CHUNK_DURATION_MS=250
ASR_VAD_THRESHOLD=0.5

# NLU
NLU_CONTEXT_LENGTH=8192
NLU_MAX_HISTORY_TURNS=10

# TTS
TTS_CHUNK_DURATION_MS=250

# RAG
RAG_CHUNK_SIZE=512
RAG_CHUNK_OVERLAP=128
RAG_TOP_K=20  # Candidates before reranking
RAG_FINAL_K=3  # Final results

# ============================================================================
# GPU Configuration
# ============================================================================
NVIDIA_VISIBLE_DEVICES=all
CUDA_VISIBLE_DEVICES=0,1,2,3  # Comma-separated GPU IDs

# Memory allocation (per service)
ASR_GPU_MEMORY_GB=6
LLM_GPU_MEMORY_GB=40
TTS_GPU_MEMORY_GB=4
RAG_GPU_MEMORY_GB=4
